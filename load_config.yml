---
- name: Load a PAN-OS configuration snippet
  hosts: all
  connection: local
  gather_facts: False
  any_errors_fatal: true

  vars:
    credentials:
      ip_address: '{{ ip_address }}'
      username: '{{ username }}'
      password: '{{ password }}'
    xml_snippet: "{{ lookup('template', 'snippets/{{ snippet_file }}') }}"
      
  roles:
    - role: paloaltonetworks.paloaltonetworks

  tasks:
  - name: Push the configuration snippet
    panos_type_cmd:
      provider: '{{ credentials }}'
      cmd: 'set'
      xpath: '{{ xpath }}'
      element: '{{ xml_snippet }}'